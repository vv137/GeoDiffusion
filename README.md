# GeoDiffusion: A Toy Experiment for Loss Function Validation

This repository tests the hypothesis that a composite loss function, similar to that in AlphaFold 3 (incorporating both MSE and a local structure term like smooth LDDT), can more effectively learn both global and local geometric features compared to a standard MSE-based diffusion loss (like in EDM).

**Problem**: Standard MSE loss in diffusion models might excel at capturing the global structure but struggle with fine-grained local geometry (e.g., precise bond angles or local motifs). Composite losses, like AF3's, aim to address this by explicitly penalizing deviations in local structure.

**Toy Task**: We model a 2D polymer chain composed of rigid V-shaped "monomers." The vertices of these V-shapes lie on a sine wave (global structure), while the internal angle of each V-shape is fixed (local structure).

* Global Task: Learn the sine wave shape. Measured by MSE on vertex positions.
* Local Task: Learn the fixed internal angle (e.g., 45 degrees). Measured by Mean Absolute Error (MAE) on the predicted internal angles.

(Generated by `plot_samples.py`)

## Experiments

We compare four conditions:

1. EDM (MSE Only): Uses EDM-style weighting on a standard L2 (MSE) loss between predicted and true clean structures. (--loss_type edm --smooth_lddt_weight 0.0)
1. EDM + SmoothLDDT: Uses EDM-style MSE weighting plus the AF3-inspired smooth_lddt_loss. (--loss_type edm --smooth_lddt_weight 1.0)
1. AF3 Weight (MSE Only): Uses AF3-style weighting on the L2 (MSE) loss. (--loss_type af3 --smooth_lddt_weight 0.0)
1. AF3 + SmoothLDDT: Uses AF3-style MSE weighting plus the smooth_lddt_loss. This mimics the AF3 diffusion loss structure. (--loss_type af3 --smooth_lddt_weight 1.0)

## Files
